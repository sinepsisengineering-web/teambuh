# TeamBuh ‚Äî –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–µ–∫—Ç–∞

> ‚ö†Ô∏è **–≠–¢–ò –ü–†–ê–í–ò–õ–ê –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´ –î–õ–Ø –°–û–ë–õ–Æ–î–ï–ù–ò–Ø –í–û –í–°–ï–ô –†–ê–ó–†–ê–ë–û–¢–ö–ï**

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å (Multi-tenant)
- **–ö–∞–∂–¥–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è = –æ—Ç–¥–µ–ª—å–Ω–∞—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–ø–∫–∞**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞: `/server/tenants/{tenantId}/`
- –í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: —Å–≤–æ—è –ë–î, —Å–≤–æ–∏ —Ñ–∞–π–ª—ã, —Å–≤–æ–π –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ù–ò–ö–û–ì–î–ê –Ω–µ —Å–º–µ—à–∏–≤–∞—é—Ç—Å—è

### –ì–∏–±—Ä–∏–¥–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –•—Ä–∞–Ω–∏–ª–∏—â–µ |
|------------|-----------|
| –ü—Ä–æ—Ñ–∏–ª–∏ (—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, –∫–ª–∏–µ–Ω—Ç—ã) | JSON —Ñ–∞–π–ª—ã |
| –ó–∞–¥–∞—á–∏, –∑–∞—Ä–ø–ª–∞—Ç–∞, —Å–≤—è–∑–∏, –ø—Ä–∞–≤–∞ | SQLite |
| –î–æ–∫—É–º–µ–Ω—Ç—ã (—Å–∫–∞–Ω—ã) | –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ `/vault/` |

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
```
/tenants/{tenantId}/
‚îú‚îÄ‚îÄ meta.json           # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ db/data.db          # SQLite –±–∞–∑–∞
‚îú‚îÄ‚îÄ employees/          # JSON –ø—Ä–æ—Ñ–∏–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
‚îú‚îÄ‚îÄ clients/            # JSON –ø—Ä–æ—Ñ–∏–ª–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ vault/              # üîê –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ .key            # –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (AES-256-GCM)
‚îî‚îÄ‚îÄ backups/            # –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –î–æ–∫—É–º–µ–Ω—Ç—ã
- –í—Å–µ —Å–∫–∞–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –¢–û–õ–¨–ö–û –≤ `/vault/`
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: AES-256-GCM
- –£ –∫–∞–∂–¥–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –°–í–û–ô –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –í SQLite —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–∏–º—è —Ñ–∞–π–ª–∞, —Ç–∏–ø, –≤–ª–∞–¥–µ–ª–µ—Ü)

### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞: —Ä–æ–ª–∏ + –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤ (expires_at)
- –ü—Ä–∞–≤–∞ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ SQLite
- –†–æ–ª–∏: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –ë—É—Ö–≥–∞–ª—Ç–µ—Ä, –ü–æ–º–æ—â–Ω–∏–∫ –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∞ (—Ä–∞—Å—à–∏—Ä—è–µ–º–æ)

---

## üÜî –ì–µ–Ω–µ—Ä–∞—Ü–∏—è ID

–§–æ—Ä–º–∞—Ç: `{prefix}_{timestamp}_{random}`

```typescript
// –ü—Ä–∏–º–µ—Ä—ã:
"org_1705680000_x7k2"   // –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
"emp_1705680000_a1b2"   // –°–æ—Ç—Ä—É–¥–Ω–∏–∫
"cli_1705680000_c3d4"   // –ö–ª–∏–µ–Ω—Ç
"task_1705680000_e5f6"  // –ó–∞–¥–∞—á–∞
"doc_1705680000_g7h8"   // –î–æ–∫—É–º–µ–Ω—Ç
```

ID —É–Ω–∏–∫–∞–ª—å–Ω—ã –í–ù–£–¢–†–ò –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ (–Ω–µ –≥–ª–æ–±–∞–ª—å–Ω–æ).

---

## üîó –°–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏

- –í—Å–µ —Å–≤—è–∑–∏ —á–µ—Ä–µ–∑ ID (soft references)
- –•—Ä–∞–Ω—è—Ç—Å—è –≤ SQLite —Ç–∞–±–ª–∏—Ü–∞—Ö
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ ‚Äî —Å–∏—Å—Ç–µ–º–∞ –ù–ï –ø–∞–¥–∞–µ—Ç
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º—ë–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

## üìÅ –ü—Ä–æ—Ñ–∏–ª–∏ (JSON)

### –°–æ—Ç—Ä—É–¥–Ω–∏–∫: `/employees/{empId}/profile.json`
```json
{
  "id": "emp_001",
  "personal": { "lastName", "firstName", "email", "phone" },
  "employment": { "type", "workType", "hireDate" },
  "documents": { "passport", "inn", "snils" },  // –î–∞–Ω–Ω—ã–µ, –ù–ï —Ñ–∞–π–ª—ã!
  "finance": { "bankName", "bankAccount", "salary", "percent" }
}
```

### –ö–ª–∏–µ–Ω—Ç: `/clients/{cliId}/profile.json`
```json
{
  "id": "cli_001",
  "company": { "name", "type", "inn", "kpp" },
  "contact": { "person", "phone", "email" },
  "accounting": { "taxSystem", "monthlyFee" }
}
```

**–ù–ï —Ö—Ä–∞–Ω–∏—Ç—å –≤ JSON:**
- –§–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (‚Üí vault)
- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (‚Üí SQLite)
- –ü–∞—Ä–æ–ª–∏ (‚Üí SQLite auth)
- –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏ (‚Üí SQLite)

---

## üóÑÔ∏è SQLite —Ç–∞–±–ª–∏—Ü—ã (–≤ –∫–∞–∂–¥–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏)

```
- documents        # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- roles            # –†–æ–ª–∏
- permissions      # –†–∞–∑—Ä–µ—à–µ–Ω–∏—è
- role_permissions # –°–≤—è–∑—å —Ä–æ–ª—å‚Üí—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- user_roles       # –ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏
- user_permissions # –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
- tasks            # –ó–∞–¥–∞—á–∏
- payroll_periods  # –ó–∞—Ä–ø–ª–∞—Ç–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã
- payroll_entries  # –ó–∞–ø–∏—Å–∏ –∑–∞—Ä–ø–ª–∞—Ç
- employee_clients # –°–≤—è–∑—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫‚Üî–∫–ª–∏–µ–Ω—Ç
- client_revenue   # –í—ã—Ä—É—á–∫–∞ –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º
- audit_log        # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- auth             # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
```

---

## üåê API

–í—Å–µ endpoints —Å–æ–¥–µ—Ä–∂–∞—Ç tenantId:
```
GET  /api/{tenantId}/employees
POST /api/{tenantId}/employees
GET  /api/{tenantId}/clients
...
```

JWT —Ç–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç: `{ tenantId, userId, role }`

---

## üì¶ –ú–∏–≥—Ä–∞—Ü–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

–ü–µ—Ä–µ–µ–∑–¥ = –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏:
```bash
cp -r /server/tenants/org_XXX /new-server/tenants/
```

–ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä—å:

- [ ] –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ tenantId?
- [ ] JSON –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π, SQLite –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π?
- [ ] –î–æ–∫—É–º–µ–Ω—Ç—ã –∏–¥—É—Ç –≤ vault —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º?
- [ ] ID –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º–∞—Ç—É `prefix_timestamp_random`?
- [ ] –°–≤—è–∑–∏ —á–µ—Ä–µ–∑ ID, –Ω–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã?
- [ ] –ü—Ä–∞–≤–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É permissions?
- [ ] API endpoint —Å–æ–¥–µ—Ä–∂–∏—Ç `/{tenantId}/`?

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: —Å–º. `data_architecture.md`

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-01-19*
